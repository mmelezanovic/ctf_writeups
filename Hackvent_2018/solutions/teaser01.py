#!/usr/bin/env python

import base64

from Crypto.Cipher import ARC4

def main():
    fuse_set0 = [0xC0, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF]
    fuse_set1 = [0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F]

    key = ''
    
    for i in range(len(fuse_set0)):
        key = key + chr(fuse_set0[i])
        key = key + chr(fuse_set1[i])

    ciphertext = [0xdf,0x66,0x58,0xc0,0x5e,0x93,0xc8,0xd4,0xc4,0xe9,0x5e,0x36,0xb1,0x55,0x14,0x4a,0xbe,0x83,0xc9,0x0a,0xdc,0x2b,0xc5,0xf0,0x8f,0xab,0xbb,0xac,0x49,0xdd,0x0f,0x01,0x97,0xf6,0x66,0x8b,0x07,0xa0,0xb4,0x43]

    ciphertext_str = ''.join([chr(c) for c in ciphertext])

    rc4_cipher = ARC4.new(key)
    plaintext = rc4_cipher.decrypt(ciphertext_str)

    print 'plaintext: {}'.format(plaintext)
    print base64.b64decode(plaintext)

if __name__ == '__main__':
    main()

